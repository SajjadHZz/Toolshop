"use client";
import { Swiper, SwiperSlide } from "swiper/react";
import "swiper/css";

import Image from "next/image";
import Link from "next/link";
import ProductCard from "@/components/modules/ProductCard/ProductCard";
import { useEffect, useState } from "react";

export default function SpecialProposal() {
  const [products, setProducts] = useState([]);
  const [isLoading, setIsLoading] = useState(true);
  useEffect(() => {
    fetchProducts();
  }, []);
  async function fetchProducts() {
    setIsLoading(true);
    const res = await fetch("http://localhost:3000/api/products", {
      next: {
        revalidate: 60 * 60 * 12,
      },
    });
    if (res.status === 200) {
      setProducts(await res.json());
      setIsLoading(false);
    }
  }
  return (
    <section className="relative overflow-hidden my-4 py-4 px-2 w-full bg-gradient-to-l from-orange-500 to-yellow-300">
      <Image
        className="w-full absolute right-0 top-0"
        width="1300"
        height="500"
        src="/images/Design Elements.png"
        alt="Design-Elements"
      />
      <Swiper autoHeight spaceBetween={10} slidesPerView={5} className="mySwiper">
        <SwiperSlide className="text-center h-full my-auto flex flex-col items-stretch justify-center gap-4">
          <h4 className="font-Lalezar text-4xl leading-snug text-text">پیشنهادات ویژه TOOLSHOP</h4>
          <svg className="w-40 mx-auto mb-4" viewBox="0 0 199 204" fill="none">
            <path
              d="M116.328 0.0692522C126.083 -1.39777 126.26 20.9017 136.289 23.4539C142.294 24.9823 154.271 19.0689 159.883 20.6266L160.07 20.6813C165.142 22.0814 165.259 27.2734 165.257 31.524C165.256 33.0757 165.388 34.7996 165.143 36.326L164.59 42.2653C162.891 52.5243 168.821 54.1579 177.427 55.9602C181.031 56.7147 188.938 58.1376 191.207 61.1073C195.768 67.0754 183.229 81.994 182.481 88.5263L182.455 88.7725C182.187 90.148 182.173 91.6277 182.546 92.9947L182.587 93.1439C183.379 96.0627 185.429 98.2465 187.481 100.365L192.04 105.026C194.648 107.739 199.819 113.43 198.89 117.45C197.225 124.65 175.895 127.681 173.937 136.127C171.4 147.067 186.758 158.472 176.949 168.012C166.662 178.018 149.05 165.934 136.042 178.945C133.963 181.024 131.473 183.987 129.971 179.78C130.251 178.537 130.959 177.504 131.657 176.461C137.134 168.285 147.534 162.001 157.581 163.549L163.972 164.517C166.449 164.909 169.772 166.082 171.488 163.623C172.639 161.974 172.353 158.695 171.991 156.779L171.088 151.798C168.221 138.957 166.166 132.024 178.807 123.819C182.796 121.23 187.074 119.187 191.213 116.866C193.069 115.826 194.046 115.539 193.616 113.277C192.656 108.235 186.748 104.681 183.405 101.159C175.319 92.6378 179.04 84.9229 183.256 75.4604L188.008 63.7988C186.729 63.1893 185.31 62.8939 183.947 62.5221L173.875 60.0768C171.92 59.6292 169.869 59.3092 167.994 58.5776C154.748 53.4085 160.853 40.0412 160.399 29.5987C160.149 23.8404 159.28 24.9416 153.747 26.0797C147.933 27.2755 140.929 29.6453 134.987 28.1516L134.832 28.1114C124.264 25.544 122.923 12.103 117.501 4.4882C109.77 8.79415 106.798 21.053 97.7812 22.9359C91.3447 24.28 87.0792 21.5642 82.1676 17.7807L77.2064 13.893C75.4648 12.4476 73.8902 10.9043 71.7865 9.99006C70.214 11.2294 69.4183 13.1694 68.6475 14.965L66.2034 21.2993C62.035 32.6828 57.0403 35.3388 45.4021 34.0812C42.5434 33.7722 28.3258 29.8696 27.21 32.6095C26.6995 33.8633 30.9858 48.1491 31.2847 51.5099C31.3699 55.477 29.9873 59.5737 26.4782 61.7982L26.2866 61.9173C24.0502 63.3377 21.4835 64.1252 19.0093 65.0285L12.5019 67.4302C11.0244 67.946 9.53716 68.3648 8.12877 69.057C11.9389 74.9653 17.8896 78.5632 20.1413 85.8092C22.95 94.8479 16.3358 103.123 10.5695 109.301C8.39925 111.626 5.64876 114.133 4.16689 116.952C4.82284 117.89 6.69663 118.709 7.69293 119.291L16.3617 124.303C22.8758 128.152 29.0703 132.622 31.0388 140.291C32.9932 147.907 29.8334 155.068 29.153 162.555C27.3439 182.453 53.8462 155.718 70.1521 185.696C73.5137 191.877 73.3903 195.849 81.8844 194.854C93.1088 193.539 96.6077 188.765 106.893 196.809C113.581 202.039 114.268 201.01 121.064 198.866L121.25 198.809C122.252 198.491 123.504 198.501 124.415 198.034L124.564 197.952C127.052 196.628 128.366 189.798 129.926 186.502C129.82 189.467 129.058 193.341 127.617 195.904L127.478 196.132C123.979 201.923 115.779 205.367 109.261 203.482C105.772 202.474 102.883 199.951 99.3923 198.99L99.1625 198.93C90.6892 196.634 81.5664 205.833 73.6244 202.253L73.4234 202.161C70.0525 200.645 68.6861 197.791 67.4935 194.486C65.9426 190.19 61.073 185.406 57.2353 183.131C54.6127 181.576 51.486 181.091 48.5157 180.668C28.7591 177.856 16.0428 177.533 25.4946 151.875C27.1718 147.321 28.5162 142.119 25.097 137.914L24.9685 137.759C19.1958 130.636 2.1605 126.537 0.157199 119.664C-1.26494 114.785 7.35334 107.091 10.2524 103.732C17.3978 95.4519 19.9357 89.6559 13.115 80.6511C11.2546 78.1957 4.914 71.8728 4.34898 69.252C3.30184 64.3944 16.2175 61.6091 19.7656 60.6961C24.5556 59.4639 28.2572 58.7374 28.1656 52.4933C28.0757 46.3891 21.4801 34.9577 24.3699 30.8657C31.1036 21.3294 51.4084 36.5028 58.5085 26.3023L58.6132 26.1476C59.8558 24.3601 60.6058 22.3738 61.3855 20.357L63.8224 14.1316C67.4044 5.05908 70.9428 2.96587 78.5843 8.66173L83.788 12.7176C92.6929 19.8382 96.3881 21.1522 103.997 11.4956C106.446 8.38728 108.958 4.92068 112.012 2.38207L112.197 2.231C113.441 1.20175 114.763 0.476381 116.328 0.0692522Z"
              fill="black"
            />
            <path
              d="M96.7418 35.0321C97.865 34.8677 98.8366 35.3379 99.3864 36.3778L99.4301 36.4632C99.7762 37.0846 99.6093 37.9134 99.6093 38.5993L99.6031 54.4678C99.9424 53.6239 101.4 51.664 101.972 50.847C105.202 46.2357 109.595 40.1063 115.562 39.3224C123.279 38.3087 127.697 43.5795 128.623 50.66L128.652 50.8867C128.912 54.0206 127.72 57.6839 125.959 60.2523C125.444 61.0024 124.044 62.9329 123.233 63.3704L145.593 63.4087C146.603 63.409 148.417 63.1102 149.318 63.642L149.402 63.6931C151.19 64.7703 150.582 67.0527 150.583 68.8245L150.585 86.8976C150.584 88.5142 151.161 92.5945 149.729 93.6638L149.589 93.7541C148.762 94.2916 147.965 94.1295 147.015 94.1311L143.119 94.135L143.093 156.669C143.073 158.031 142.607 159.572 140.923 159.66L97.4378 159.681L53.6173 159.67C53.2519 159.657 52.8642 159.616 52.6054 159.33L52.5361 159.251C52.1315 158.809 51.8743 158.396 51.7145 157.812L51.6856 157.702C51.4535 156.87 51.4983 155.932 51.4937 155.073L51.4513 94.133H48.9076C47.0211 94.1681 44.6047 94.6385 44.0827 92.2065L44.0552 92.0701C44.0269 91.9393 44.0014 91.8232 44 91.6878L44.0359 68.1358C44.0506 64.3801 43.4601 63.4055 48.0218 63.4055L71.4113 63.3837C71.0578 63.1341 70.9393 62.9104 70.6582 62.6102C64.9637 56.533 63.4276 46.3089 70.9401 41.0269C74.2678 38.687 78.9302 38.6057 82.494 40.4715C86.7211 42.6845 89.6764 46.8727 92.3494 50.6942L95.0937 54.7514C95.0211 54.2433 94.954 53.7275 94.935 53.2145L94.92 38.7761C94.9208 38.1634 94.8249 37.3073 95.0364 36.7351L95.1283 36.4893C95.433 35.6713 95.9975 35.3683 96.7418 35.0321ZM76.4689 43.896C75.1653 44.0926 72.8546 44.6129 72.34 46.0443C73.6327 52.2148 84.4452 56.4694 89.5469 58.6536L92.6439 59.8249C91.7277 57.7208 90.2544 55.8 88.9314 53.9336C86.1183 49.9656 82.1307 43.4091 76.4689 43.896ZM116.706 43.983C113.546 44.3073 111.461 46.4032 109.548 48.7604L103.827 56.4305C103.137 57.4441 102.312 58.5427 101.842 59.6748L106.014 58.2146C110.893 56.21 119.032 52.6523 121.692 47.678L121.756 47.5606C123.239 44.7809 118.69 43.7397 116.706 43.983ZM70.4597 52.201C72.7328 61.156 78.0287 63.2597 86.583 63.4454C87.2398 63.4598 88.2683 63.6276 88.8917 63.4791L89.1193 63.5574L77.7563 58.195C74.9802 56.741 72.5858 54.4662 70.4597 52.201ZM123.927 52.3934C120.68 57.3549 110.815 61.4153 105.504 63.4384L105.675 63.5025L110.012 63.3848C116.683 63.089 123.065 59.4565 124.055 52.4092L123.927 52.3934Z"
              fill="black"
            />
            <path
              d="M89.0746 68.07L105.772 68.1665L105.792 89.3964L89.0833 89.4282L89.0746 68.07Z"
              fill="#FFBF00"
            />
            <path
              d="M110.621 68.1108L145.844 68.154L145.855 86.4161C145.854 87.4071 145.918 88.4451 145.818 89.4304L145.582 89.4475L110.449 89.4592L110.621 68.1108Z"
              fill="#FFBF00"
            />
            <path
              d="M50.7077 89.4606L48.7603 89.4894L48.8266 68.0969L51.5475 68.1404L82.3523 68.1453C82.8708 68.1426 83.9711 68.0029 84.4213 68.185L84.396 89.4674L50.7077 89.4606Z"
              fill="#FFBF00"
            />
            <path
              d="M56.2949 94.0648L138.383 94.1129L138.388 154.98L56.3167 154.939L56.2949 94.0648Z"
              fill="#FFBF00"
            />
            <path
              d="M60.1154 99.122L60.304 99.1135C60.6665 99.353 60.8421 99.7209 60.9465 100.132L60.9775 100.259C61.3644 101.768 61.3997 103.512 61.4467 105.062L61.4563 149.62C61.4465 150.324 61.6914 151.215 60.9296 151.522L59.9226 151.692C59.6847 149.785 59.8546 147.673 59.8555 145.747L59.8772 100.325C59.8867 99.8984 59.8756 99.4925 60.1154 99.122Z"
              fill="white"
            />
            <path
              d="M107.569 126.387C109.682 126.237 111.75 126.944 113.384 128.277C119.772 133.489 116.49 143.365 108.547 144.064C97.68 144.919 95.3843 127.533 107.569 126.387Z"
              fill="black"
            />
            <path
              d="M107.795 131.135C113.368 130.818 113.777 138.368 108.347 139.496C107.892 139.521 107.502 139.536 107.059 139.407L106.911 139.361C102.66 138.074 102.719 131.813 107.795 131.135Z"
              fill="#FFBF00"
            />
            <path
              d="M113.829 103.337C116.04 103.221 117.376 105.977 115.81 107.545L111.355 111.709L81.317 141.282C80.9912 141.569 80.6356 141.754 80.2267 141.898C77.5594 142.013 76.6383 139.419 78.5052 137.464L110.377 106.234C111.431 105.198 112.473 103.965 113.829 103.337Z"
              fill="black"
            />
            <path
              d="M86.2434 99.8802C90.7878 99.5695 94.8917 103.196 95.4404 107.667C96.0341 112.505 92.2543 117.085 87.4336 117.595C75.2175 117.769 74.4502 101.016 86.2434 99.8802Z"
              fill="black"
            />
            <path
              d="M86.3703 104.63C88.222 104.536 90.0408 105.421 90.6667 107.27L90.8102 107.759C91.252 110.364 89.421 112.545 86.8806 112.904C81.9705 113.316 80.1742 105.303 86.3703 104.63Z"
              fill="#FFBF00"
            />
          </svg>
          <Link href="/products" className="text-text group">
            مشاهده همه
            <svg
              width="20"
              height="9"
              viewBox="0 0 20 9"
              className="fill-text inline-block mx-2 transition group-hover:-translate-x-2"
            >
              <path d="M18.75 3.7175H2.56L5 1.2775C5.29 0.987499 5.29 0.5075 5 0.2175C4.71 -0.0725 4.23 -0.0725 3.94 0.2175L0.23 3.9275C0.16 3.9975 0.0999999 4.0875 0.0599999 4.1875C0.0599999 4.1975 0.06 4.2075 0.05 4.2175C0.02 4.2975 0 4.3875 0 4.4775C0 4.6775 0.08 4.8675 0.22 5.0075L3.94 8.7275C4.09 8.8775 4.28 8.9475 4.47 8.9475C4.66 8.9475 4.85 8.8775 5 8.7275C5.29 8.4375 5.29 7.9575 5 7.6675L2.55 5.2175H18.75C19.16 5.2175 19.5 4.8775 19.5 4.4675C19.5 4.0575 19.16 3.7175 18.75 3.7175Z" />
            </svg>
          </Link>
        </SwiperSlide>
        {isLoading
          ? [1, 2, 3, 4, 5].map((item) => {
              return (
                <SwiperSlide
                  key={item}
                  className="h-full min-h-full overflow-hidden rounded-xl bg-white shadow max-h-none"
                >
                  <div className="h-full overflow-hidden rounded-xl bg-gray-200 animate-pulse shadow relative">
                    <div className="relative group ">
                      <div className="w-full h-72"></div>
                      <div className="absolute top-0 left-0 w-full h-full opacity-50 bg-black/40 rounded-xl transition-opacity group-hover:opacity-100"></div>
                    </div>
                    <div className="p-4">
                      <div className="w-full h-4 leading-normal bg-gray-300 rounded-full"></div>
                      <div className="join w-full my-4">
                        <div className="join-item flex-1 btn px-0 bg-gray-200 font-normal"></div>
                        <div className="join-item flex-1 btn px-0 bg-gray-200 font-normal"></div>
                      </div>
                      <div className="flex items-center gap-4 mb-2">
                        <span className="bg-gray-300 w-1/2 h-2 inline-block rounded-sm"></span>
                        <span className="w-6 h-4 inline-block rounded-full bg-gray-300 mx-2"></span>
                      </div>
                      <p className="w-10 h-2 bg-gray-300 block rounded-sm"></p>
                    </div>
                    <span className="w-10 h-10 absolute left-0 bottom-0 inline-block bg-gray-300 rounded-tr-xl"></span>
                  </div>
                </SwiperSlide>
              );
            })
          : products.map((product) => {
              return (
                <SwiperSlide
                  key={product._id}
                  className="h-full min-h-full overflow-hidden rounded-xl bg-white shadow max-h-none"
                >
                  <ProductCard
                    _id={product._id}
                    img={product.img}
                    name={product.name}
                    price={product.price}
                    wholesale={product.wholesale}
                    discount={product.discount}
                    attributes={product.attributes}
                  />
                </SwiperSlide>
              );
            })}
      </Swiper>
    </section>
  );
}
